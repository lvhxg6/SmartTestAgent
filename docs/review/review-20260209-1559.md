# Review Report

## 1) 摘要
本次为文档一致性审查（场景A：仅文档审查），对比 `requirements.md` 与 `docs/ancient-hatching-mitten.md` 的 17 条需求。结论：主流程基本覆盖，但存在 5 处明确缺项/弱化点，主要集中在配置能力、React 组件支持、选择器规则与监控细节。

## 2) 问题清单

### 中
1. 缺少 `ignoreHTTPSErrors` 与 Ant Design quirks 配置定义，导致 Requirement 1 未完整落地。  
   - 要求证据：`.kiro/specs/prd-ui-testing-agent/requirements.md:30`、`.kiro/specs/prd-ui-testing-agent/requirements.md:31`  
   - 设计现状：`docs/ancient-hatching-mitten.md:72` 至 `docs/ancient-hatching-mitten.md:100` 的 `target_profile` 示例与 `docs/ancient-hatching-mitten.md:105` 至 `docs/ancient-hatching-mitten.md:114` 字段说明均未包含 `ignoreHTTPSErrors`、`button_text_space`、`select_type`、`modal_close_selector`。

2. React 组件格式支持未被明确设计，Requirement 2 存在口径缺口。  
   - 要求证据：`.kiro/specs/prd-ui-testing-agent/requirements.md:43`  
   - 设计现状：目录结构与示例仍偏 Vue 约束（`docs/ancient-hatching-mitten.md:418`、`docs/ancient-hatching-mitten.md:157`），未明确 `.tsx/.jsx` 提取路径与裁剪规则。

3. 两字中文按钮正则选择器规则缺失，Requirement 4 未完整覆盖。  
   - 要求证据：`.kiro/specs/prd-ui-testing-agent/requirements.md:65`  
   - 设计现状：选择器优先级有定义，但未声明两字中文按钮使用正则（`docs/ancient-hatching-mitten.md:121` 至 `docs/ancient-hatching-mitten.md:127`）。

4. Codex 对 P0 用例覆盖的强校验职责未显式化，Requirement 5 存在弱化。  
   - 要求证据：`.kiro/specs/prd-ui-testing-agent/requirements.md:79`  
   - 设计现状：仅描述“覆盖率是否足够”，未写出“逐条确保 P0 均有对应 test case”的审核输出要求（`docs/ancient-hatching-mitten.md:206`）。

5. 监控页面展示项不完整：缺少“已完成步骤/剩余步骤、步骤截图预览”的明确交付描述。  
   - 要求证据：`.kiro/specs/prd-ui-testing-agent/requirements.md:212`、`.kiro/specs/prd-ui-testing-agent/requirements.md:213`  
   - 设计现状：已有 WebSocket 推送与“执行监控”总述（`docs/ancient-hatching-mitten.md:690`、`docs/ancient-hatching-mitten.md:342`），但未落到该级别 UI 字段定义。

## 3) 修改建议
1. 在 `target_profile.browser` 增加 `ignoreHTTPSErrors`，并新增 `antd_quirks` 对象（`button_text_space`、`select_type`、`modal_close_selector`）及传递到 Playwright context 的说明。  
2. 在源码索引章节补充“双栈支持”小节：分别给出 Vue(`.vue`) 与 React(`.tsx/.jsx`) 的组件定位与大文件裁剪规则。  
3. 在选择器策略中新增强规则：两字中文按钮优先正则（示例 `/关.*闭/`），并写明触发条件。  
4. 在 Codex 用例审核输出中增加 `p0_coverage_check`（pass/fail + missing_p0_ids）字段，显式承接 Requirement 5。  
5. 在监控页面章节补齐字段：`current_state`、`completed_steps`、`remaining_steps`、`step_screenshot_preview`，并说明与 WebSocket 事件的映射。

## 5) 风险/待确认点
- 当前设计文档已扩展为“全量能力一次性交付”，而 `requirements.md` 仍是需求基线；若后续继续以该基线验收，建议先确认“扩展项是否纳入正式验收范围”。
- 本次审查范围仅限上述两份文档，未联动代码实现与接口契约文件。
